{"ast":null,"code":"'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar asyncCapableHelper = require('../../../../helper/AsyncCapableHelper');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nfunction isAsyncBefore(bo) {\n  return asyncCapableHelper.isAsyncBefore(bo);\n}\n\nfunction isAsyncAfter(bo) {\n  return asyncCapableHelper.isAsyncAfter(bo);\n}\n\nfunction getFailedJobRetryTimeCycle(bo) {\n  return asyncCapableHelper.getFailedJobRetryTimeCycle(bo);\n}\n\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  return asyncCapableHelper.removeFailedJobRetryTimeCycle(bo, element);\n}\n\nfunction createExtensionElements(parent, bpmnFactory) {\n  return elementHelper.createElement('bpmn:ExtensionElements', {\n    values: []\n  }, parent, bpmnFactory);\n}\n\nfunction createFailedJobRetryTimeCycle(parent, bpmnFactory, cycle) {\n  return elementHelper.createElement('camunda:FailedJobRetryTimeCycle', {\n    body: cycle\n  }, parent, bpmnFactory);\n}\n\nmodule.exports = function (element, bpmnFactory, options, translate) {\n  var getBusinessObject = options.getBusinessObject;\n  var idPrefix = options.idPrefix || '',\n      labelPrefix = options.labelPrefix || '';\n  var retryTimeCycleEntry = entryFactory.textField({\n    id: idPrefix + 'retryTimeCycle',\n    label: labelPrefix + translate('Retry Time Cycle'),\n    modelProperty: 'cycle',\n    get: function (element, node) {\n      var retryTimeCycle = getFailedJobRetryTimeCycle(getBusinessObject(element));\n      var value = retryTimeCycle && retryTimeCycle.get('body');\n      return {\n        cycle: value\n      };\n    },\n    set: function (element, values, node) {\n      var newCycle = values.cycle;\n      var bo = getBusinessObject(element);\n\n      if (newCycle === '' || typeof newCycle === 'undefined') {\n        // remove retry time cycle element(s)\n        return removeFailedJobRetryTimeCycle(bo, element);\n      }\n\n      var retryTimeCycle = getFailedJobRetryTimeCycle(bo);\n\n      if (!retryTimeCycle) {\n        // add new retry time cycle element\n        var commands = [];\n        var extensionElements = bo.get('extensionElements');\n\n        if (!extensionElements) {\n          extensionElements = createExtensionElements(bo, bpmnFactory);\n          commands.push(cmdHelper.updateBusinessObject(element, bo, {\n            extensionElements: extensionElements\n          }));\n        }\n\n        retryTimeCycle = createFailedJobRetryTimeCycle(extensionElements, bpmnFactory, newCycle);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(element, extensionElements, 'values', 'extensionElements', [retryTimeCycle], []));\n        return commands;\n      } // update existing retry time cycle element\n\n\n      return cmdHelper.updateBusinessObject(element, retryTimeCycle, {\n        body: newCycle\n      });\n    },\n    hidden: function (element) {\n      var bo = getBusinessObject(element);\n\n      if (bo && (isAsyncBefore(bo) || isAsyncAfter(bo))) {\n        return false;\n      }\n\n      if (is(element, 'bpmn:Event')) {\n        return !eventDefinitionHelper.getTimerEventDefinition(element);\n      }\n\n      return true;\n    }\n  });\n  return [retryTimeCycleEntry];\n};","map":{"version":3,"sources":["C:/Users/Vittorio/Documents/GitHub/SPM2021-MTV/frontend/node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/JobRetryTimeCycle.js"],"names":["is","require","entryFactory","asyncCapableHelper","elementHelper","eventDefinitionHelper","cmdHelper","isAsyncBefore","bo","isAsyncAfter","getFailedJobRetryTimeCycle","removeFailedJobRetryTimeCycle","element","createExtensionElements","parent","bpmnFactory","createElement","values","createFailedJobRetryTimeCycle","cycle","body","module","exports","options","translate","getBusinessObject","idPrefix","labelPrefix","retryTimeCycleEntry","textField","id","label","modelProperty","get","node","retryTimeCycle","value","set","newCycle","commands","extensionElements","push","updateBusinessObject","addAndRemoveElementsFromList","hidden","getTimerEventDefinition"],"mappings":"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","sourcesContent":["'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar asyncCapableHelper = require('../../../../helper/AsyncCapableHelper');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nfunction isAsyncBefore(bo) {\n  return asyncCapableHelper.isAsyncBefore(bo);\n}\n\nfunction isAsyncAfter(bo) {\n  return asyncCapableHelper.isAsyncAfter(bo);\n}\n\nfunction getFailedJobRetryTimeCycle(bo) {\n  return asyncCapableHelper.getFailedJobRetryTimeCycle(bo);\n}\n\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  return asyncCapableHelper.removeFailedJobRetryTimeCycle(bo, element);\n}\n\nfunction createExtensionElements(parent, bpmnFactory) {\n  return elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, parent, bpmnFactory);\n}\n\nfunction createFailedJobRetryTimeCycle(parent, bpmnFactory, cycle) {\n  return elementHelper.createElement('camunda:FailedJobRetryTimeCycle', { body: cycle }, parent, bpmnFactory);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var idPrefix = options.idPrefix || '',\n      labelPrefix = options.labelPrefix || '';\n\n  var retryTimeCycleEntry = entryFactory.textField({\n    id: idPrefix + 'retryTimeCycle',\n    label: labelPrefix + translate('Retry Time Cycle'),\n    modelProperty: 'cycle',\n\n    get: function(element, node) {\n      var retryTimeCycle = getFailedJobRetryTimeCycle(getBusinessObject(element));\n      var value = retryTimeCycle && retryTimeCycle.get('body');\n      return {\n        cycle: value\n      };\n    },\n\n    set: function(element, values, node) {\n      var newCycle = values.cycle;\n      var bo = getBusinessObject(element);\n\n      if (newCycle === '' || typeof newCycle === 'undefined') {\n        // remove retry time cycle element(s)\n        return removeFailedJobRetryTimeCycle(bo, element);\n      }\n\n      var retryTimeCycle = getFailedJobRetryTimeCycle(bo);\n\n      if (!retryTimeCycle) {\n        // add new retry time cycle element\n        var commands = [];\n\n        var extensionElements = bo.get('extensionElements');\n        if (!extensionElements) {\n          extensionElements = createExtensionElements(bo, bpmnFactory);\n          commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n        }\n\n        retryTimeCycle = createFailedJobRetryTimeCycle(extensionElements, bpmnFactory, newCycle);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(\n          element,\n          extensionElements,\n          'values',\n          'extensionElements',\n          [ retryTimeCycle ],\n          []\n        ));\n\n        return commands;\n      }\n\n      // update existing retry time cycle element\n      return cmdHelper.updateBusinessObject(element, retryTimeCycle, { body: newCycle });\n    },\n\n    hidden: function(element) {\n      var bo = getBusinessObject(element);\n\n      if (bo && (isAsyncBefore(bo) || isAsyncAfter(bo))) {\n        return false;\n      }\n\n      if (is(element, 'bpmn:Event')) {\n        return !eventDefinitionHelper.getTimerEventDefinition(element);\n      }\n\n      return true;\n    }\n\n  });\n\n  return [ retryTimeCycleEntry ];\n\n};\n"]},"metadata":{},"sourceType":"script"}