{"ast":null,"code":"import { assign } from 'min-dash';\nimport { toPoint } from '../../util/Event';\n/**\n * Initiates canvas scrolling if current cursor point is close to a border.\n * Cancelled when current point moves back inside the scrolling borders\n * or cancelled manually.\n *\n * Default options :\n *   scrollThresholdIn: [ 20, 20, 20, 20 ],\n *   scrollThresholdOut: [ 0, 0, 0, 0 ],\n *   scrollRepeatTimeout: 15,\n *   scrollStep: 10\n *\n * Threshold order:\n *   [ left, top, right, bottom ]\n */\n\nexport default function AutoScroll(config, eventBus, canvas, mouseTracking) {\n  this._canvas = canvas;\n  this._mouseTracking = mouseTracking;\n  this._opts = assign({\n    scrollThresholdIn: [20, 20, 20, 20],\n    scrollThresholdOut: [0, 0, 0, 0],\n    scrollRepeatTimeout: 15,\n    scrollStep: 10\n  }, config);\n  var self = this;\n  eventBus.on('drag.move', function (e) {\n    var point = self._toBorderPoint(e);\n\n    self.startScroll(point);\n  });\n  eventBus.on(['drag.cleanup'], function () {\n    self.stopScroll();\n  });\n}\nAutoScroll.$inject = ['config.autoScroll', 'eventBus', 'canvas', 'mouseTracking'];\n/**\n * Starts scrolling loop.\n * Point is given in global scale in canvas container box plane.\n *\n * @param  {Object} point { x: X, y: Y }\n */\n\nAutoScroll.prototype.startScroll = function (point) {\n  var canvas = this._canvas;\n  var opts = this._opts;\n  var self = this;\n  var clientRect = canvas.getContainer().getBoundingClientRect();\n  var diff = [point.x, point.y, clientRect.width - point.x, clientRect.height - point.y];\n  this.stopScroll();\n  var dx = 0,\n      dy = 0;\n\n  for (var i = 0; i < 4; i++) {\n    if (between(diff[i], opts.scrollThresholdOut[i], opts.scrollThresholdIn[i])) {\n      if (i === 0) {\n        dx = opts.scrollStep;\n      } else if (i == 1) {\n        dy = opts.scrollStep;\n      } else if (i == 2) {\n        dx = -opts.scrollStep;\n      } else if (i == 3) {\n        dy = -opts.scrollStep;\n      }\n    }\n  }\n\n  if (dx !== 0 || dy !== 0) {\n    canvas.scroll({\n      dx: dx,\n      dy: dy\n    });\n    this._scrolling = setTimeout(function () {\n      self.startScroll(point);\n    }, opts.scrollRepeatTimeout);\n  }\n};\n\nfunction between(val, start, end) {\n  if (start < val && val < end) {\n    return true;\n  }\n\n  return false;\n}\n/**\n * Stops scrolling loop.\n */\n\n\nAutoScroll.prototype.stopScroll = function () {\n  clearTimeout(this._scrolling);\n};\n/**\n * Overrides defaults options.\n *\n * @param  {Object} options\n */\n\n\nAutoScroll.prototype.setOptions = function (options) {\n  this._opts = assign({}, this._opts, options);\n};\n/**\n * Converts event to a point in canvas container plane in global scale.\n *\n * @param  {Event} event\n * @return {Point}\n */\n\n\nAutoScroll.prototype._toBorderPoint = function (event) {\n  var clientRect = this._canvas._container.getBoundingClientRect();\n\n  var globalPosition = toPoint(event.originalEvent);\n  return {\n    x: globalPosition.x - clientRect.left,\n    y: globalPosition.y - clientRect.top\n  };\n};","map":{"version":3,"sources":["C:/Users/Vittorio/Documents/GitHub/SPM2021-MTV/frontend/node_modules/diagram-js/lib/features/auto-scroll/AutoScroll.js"],"names":["assign","toPoint","AutoScroll","config","eventBus","canvas","mouseTracking","_canvas","_mouseTracking","_opts","scrollThresholdIn","scrollThresholdOut","scrollRepeatTimeout","scrollStep","self","on","e","point","_toBorderPoint","startScroll","stopScroll","$inject","prototype","opts","clientRect","getContainer","getBoundingClientRect","diff","x","y","width","height","dx","dy","i","between","scroll","_scrolling","setTimeout","val","start","end","clearTimeout","setOptions","options","event","_container","globalPosition","originalEvent","left","top"],"mappings":"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","sourcesContent":["import { assign } from 'min-dash';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\n\n/**\n * Initiates canvas scrolling if current cursor point is close to a border.\n * Cancelled when current point moves back inside the scrolling borders\n * or cancelled manually.\n *\n * Default options :\n *   scrollThresholdIn: [ 20, 20, 20, 20 ],\n *   scrollThresholdOut: [ 0, 0, 0, 0 ],\n *   scrollRepeatTimeout: 15,\n *   scrollStep: 10\n *\n * Threshold order:\n *   [ left, top, right, bottom ]\n */\nexport default function AutoScroll(config, eventBus, canvas, mouseTracking) {\n\n  this._canvas = canvas;\n  this._mouseTracking = mouseTracking;\n\n  this._opts = assign({\n    scrollThresholdIn: [ 20, 20, 20, 20 ],\n    scrollThresholdOut: [ 0, 0, 0, 0 ],\n    scrollRepeatTimeout: 15,\n    scrollStep: 10\n  }, config);\n\n  var self = this;\n\n  eventBus.on('drag.move', function(e) {\n    var point = self._toBorderPoint(e);\n\n    self.startScroll(point);\n  });\n\n  eventBus.on([ 'drag.cleanup' ], function() {\n    self.stopScroll();\n  });\n}\n\nAutoScroll.$inject = [\n  'config.autoScroll',\n  'eventBus',\n  'canvas',\n  'mouseTracking'\n];\n\n\n/**\n * Starts scrolling loop.\n * Point is given in global scale in canvas container box plane.\n *\n * @param  {Object} point { x: X, y: Y }\n */\nAutoScroll.prototype.startScroll = function(point) {\n\n  var canvas = this._canvas;\n  var opts = this._opts;\n  var self = this;\n\n  var clientRect = canvas.getContainer().getBoundingClientRect();\n\n  var diff = [\n    point.x,\n    point.y,\n    clientRect.width - point.x,\n    clientRect.height - point.y\n  ];\n\n  this.stopScroll();\n\n  var dx = 0,\n      dy = 0;\n\n  for (var i = 0; i < 4; i++) {\n    if (between(diff[i], opts.scrollThresholdOut[i], opts.scrollThresholdIn[i])) {\n      if (i === 0) {\n        dx = opts.scrollStep;\n      } else if (i == 1) {\n        dy = opts.scrollStep;\n      } else if (i == 2) {\n        dx = -opts.scrollStep;\n      } else if (i == 3) {\n        dy = -opts.scrollStep;\n      }\n    }\n  }\n\n  if (dx !== 0 || dy !== 0) {\n    canvas.scroll({ dx: dx, dy: dy });\n\n    this._scrolling = setTimeout(function() {\n      self.startScroll(point);\n    }, opts.scrollRepeatTimeout);\n  }\n};\n\nfunction between(val, start, end) {\n  if (start < val && val < end) {\n    return true;\n  }\n\n  return false;\n}\n\n\n/**\n * Stops scrolling loop.\n */\nAutoScroll.prototype.stopScroll = function() {\n  clearTimeout(this._scrolling);\n};\n\n\n/**\n * Overrides defaults options.\n *\n * @param  {Object} options\n */\nAutoScroll.prototype.setOptions = function(options) {\n  this._opts = assign({}, this._opts, options);\n};\n\n\n/**\n * Converts event to a point in canvas container plane in global scale.\n *\n * @param  {Event} event\n * @return {Point}\n */\nAutoScroll.prototype._toBorderPoint = function(event) {\n  var clientRect = this._canvas._container.getBoundingClientRect();\n\n  var globalPosition = toPoint(event.originalEvent);\n\n  return {\n    x: globalPosition.x - clientRect.left,\n    y: globalPosition.y - clientRect.top\n  };\n};"]},"metadata":{},"sourceType":"module"}