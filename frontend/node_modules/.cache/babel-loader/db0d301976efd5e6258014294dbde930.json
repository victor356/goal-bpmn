{"ast":null,"code":"var MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\nexport default function GlobalConnect(eventBus, dragging, connect, canvas, toolManager) {\n  var self = this;\n  this._dragging = dragging;\n  toolManager.registerTool('global-connect', {\n    tool: 'global-connect',\n    dragging: 'global-connect.drag'\n  });\n  eventBus.on('global-connect.hover', function (event) {\n    var context = event.context,\n        startTarget = event.hover;\n    var canStartConnect = context.canStartConnect = self.canStartConnect(startTarget); // simply ignore hover\n\n    if (canStartConnect === null) {\n      return;\n    }\n\n    context.startTarget = startTarget;\n    canvas.addMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n  });\n  eventBus.on(['global-connect.out', 'global-connect.cleanup'], function (event) {\n    var startTarget = event.context.startTarget,\n        canStartConnect = event.context.canStartConnect;\n\n    if (startTarget) {\n      canvas.removeMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n  eventBus.on(['global-connect.ended'], function (event) {\n    var context = event.context,\n        startTarget = context.startTarget,\n        startPosition = {\n      x: event.x,\n      y: event.y\n    };\n    var canStartConnect = self.canStartConnect(startTarget);\n\n    if (!canStartConnect) {\n      return;\n    }\n\n    eventBus.once('element.out', function () {\n      eventBus.once(['connect.ended', 'connect.canceled'], function () {\n        eventBus.fire('global-connect.drag.ended');\n      });\n      connect.start(null, startTarget, startPosition);\n    });\n    return false;\n  });\n}\nGlobalConnect.$inject = ['eventBus', 'dragging', 'connect', 'canvas', 'toolManager'];\n/**\n * Initiates tool activity.\n */\n\nGlobalConnect.prototype.start = function (event) {\n  this._dragging.init(event, 'global-connect', {\n    trapClick: false,\n    data: {\n      context: {}\n    }\n  });\n};\n\nGlobalConnect.prototype.toggle = function () {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.start();\n  }\n};\n\nGlobalConnect.prototype.isActive = function () {\n  var context = this._dragging.context();\n\n  return context && /^global-connect/.test(context.prefix);\n};\n\nGlobalConnect.prototype.registerProvider = function (provider) {\n  this._provider = provider;\n};\n/**\n * Check if source shape can initiate connection.\n *\n * @param  {Shape} startTarget\n * @return {Boolean}\n */\n\n\nGlobalConnect.prototype.canStartConnect = function (startTarget) {\n  return this._provider.canStartConnect(startTarget);\n};","map":{"version":3,"sources":["C:/Users/Vittorio/Documents/GitHub/SPM2021-MTV/frontend/node_modules/bpmn-js/node_modules/diagram-js/lib/features/global-connect/GlobalConnect.js"],"names":["MARKER_OK","MARKER_NOT_OK","GlobalConnect","eventBus","dragging","connect","canvas","toolManager","self","_dragging","registerTool","tool","on","event","context","startTarget","hover","canStartConnect","addMarker","removeMarker","startPosition","x","y","once","fire","start","$inject","prototype","init","trapClick","data","toggle","isActive","cancel","test","prefix","registerProvider","provider","_provider"],"mappings":"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","sourcesContent":["var MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n\nexport default function GlobalConnect(\n    eventBus, dragging, connect,\n    canvas, toolManager) {\n\n  var self = this;\n\n  this._dragging = dragging;\n\n  toolManager.registerTool('global-connect', {\n    tool: 'global-connect',\n    dragging: 'global-connect.drag'\n  });\n\n  eventBus.on('global-connect.hover', function(event) {\n    var context = event.context,\n        startTarget = event.hover;\n\n    var canStartConnect = context.canStartConnect = self.canStartConnect(startTarget);\n\n    // simply ignore hover\n    if (canStartConnect === null) {\n      return;\n    }\n\n    context.startTarget = startTarget;\n\n    canvas.addMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n\n  eventBus.on([ 'global-connect.out', 'global-connect.cleanup' ], function(event) {\n    var startTarget = event.context.startTarget,\n        canStartConnect = event.context.canStartConnect;\n\n    if (startTarget) {\n      canvas.removeMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n\n  eventBus.on([ 'global-connect.ended' ], function(event) {\n    var context = event.context,\n        startTarget = context.startTarget,\n        startPosition = {\n          x: event.x,\n          y: event.y\n        };\n\n    var canStartConnect = self.canStartConnect(startTarget);\n\n    if (!canStartConnect) {\n      return;\n    }\n\n    eventBus.once('element.out', function() {\n      eventBus.once([ 'connect.ended', 'connect.canceled' ], function() {\n        eventBus.fire('global-connect.drag.ended');\n      });\n\n      connect.start(null, startTarget, startPosition);\n    });\n\n    return false;\n  });\n}\n\nGlobalConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'connect',\n  'canvas',\n  'toolManager'\n];\n\n\n/**\n * Initiates tool activity.\n */\nGlobalConnect.prototype.start = function(event) {\n  this._dragging.init(event, 'global-connect', {\n    trapClick: false,\n    data: {\n      context: {}\n    }\n  });\n};\n\n\nGlobalConnect.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.start();\n  }\n};\n\nGlobalConnect.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^global-connect/.test(context.prefix);\n};\n\n\nGlobalConnect.prototype.registerProvider = function(provider) {\n  this._provider = provider;\n};\n\n\n/**\n * Check if source shape can initiate connection.\n *\n * @param  {Shape} startTarget\n * @return {Boolean}\n */\nGlobalConnect.prototype.canStartConnect = function(startTarget) {\n  return this._provider.canStartConnect(startTarget);\n};\n"]},"metadata":{},"sourceType":"module"}