{"ast":null,"code":"'use strict';\n\nvar some = require('min-dash').some;\n\nvar ALLOWED_TYPES = {\n  FailedJobRetryTimeCycle: ['bpmn:StartEvent', 'bpmn:BoundaryEvent', 'bpmn:IntermediateCatchEvent', 'bpmn:Activity'],\n  Connector: ['bpmn:EndEvent', 'bpmn:IntermediateThrowEvent'],\n  Field: ['bpmn:EndEvent', 'bpmn:IntermediateThrowEvent']\n};\n\nfunction is(element, type) {\n  return element && typeof element.$instanceOf === 'function' && element.$instanceOf(type);\n}\n\nfunction exists(element) {\n  return element && element.length;\n}\n\nfunction includesType(collection, type) {\n  return exists(collection) && some(collection, function (element) {\n    return is(element, type);\n  });\n}\n\nfunction anyType(element, types) {\n  return some(types, function (type) {\n    return is(element, type);\n  });\n}\n\nfunction isAllowed(propName, propDescriptor, newElement) {\n  var name = propDescriptor.name,\n      types = ALLOWED_TYPES[name.replace(/camunda:/, '')];\n  return name === propName && anyType(newElement, types);\n}\n\nfunction CamundaModdleExtension(eventBus) {\n  eventBus.on('property.clone', function (context) {\n    var newElement = context.newElement,\n        propDescriptor = context.propertyDescriptor;\n    this.canCloneProperty(newElement, propDescriptor);\n  }, this);\n}\n\nCamundaModdleExtension.$inject = ['eventBus'];\n\nCamundaModdleExtension.prototype.canCloneProperty = function (newElement, propDescriptor) {\n  if (isAllowed('camunda:FailedJobRetryTimeCycle', propDescriptor, newElement)) {\n    return includesType(newElement.eventDefinitions, 'bpmn:TimerEventDefinition') || includesType(newElement.eventDefinitions, 'bpmn:SignalEventDefinition') || is(newElement.loopCharacteristics, 'bpmn:MultiInstanceLoopCharacteristics');\n  }\n\n  if (isAllowed('camunda:Connector', propDescriptor, newElement)) {\n    return includesType(newElement.eventDefinitions, 'bpmn:MessageEventDefinition');\n  }\n\n  if (isAllowed('camunda:Field', propDescriptor, newElement)) {\n    return includesType(newElement.eventDefinitions, 'bpmn:MessageEventDefinition');\n  }\n};\n\nmodule.exports = CamundaModdleExtension;","map":{"version":3,"sources":["C:/Users/Vittorio/Documents/GitHub/goal-bpmn/frontend/node_modules/camunda-bpmn-moddle/lib/extension.js"],"names":["some","require","ALLOWED_TYPES","FailedJobRetryTimeCycle","Connector","Field","is","element","type","$instanceOf","exists","length","includesType","collection","anyType","types","isAllowed","propName","propDescriptor","newElement","name","replace","CamundaModdleExtension","eventBus","on","context","propertyDescriptor","canCloneProperty","$inject","prototype","eventDefinitions","loopCharacteristics","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nvar some = require('min-dash').some;\n\nvar ALLOWED_TYPES = {\n  FailedJobRetryTimeCycle: [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateCatchEvent',\n    'bpmn:Activity'\n  ],\n  Connector: [ 'bpmn:EndEvent', 'bpmn:IntermediateThrowEvent' ],\n  Field: [ 'bpmn:EndEvent', 'bpmn:IntermediateThrowEvent' ]\n};\n\n\nfunction is(element, type) {\n  return element && (typeof element.$instanceOf === 'function') && element.$instanceOf(type);\n}\n\nfunction exists(element) {\n  return element && element.length;\n}\n\nfunction includesType(collection, type) {\n  return exists(collection) && some(collection, function(element) {\n    return is(element, type);\n  });\n}\n\nfunction anyType(element, types) {\n  return some(types, function(type) {\n    return is(element, type);\n  });\n}\n\nfunction isAllowed(propName, propDescriptor, newElement) {\n  var name = propDescriptor.name,\n      types = ALLOWED_TYPES[ name.replace(/camunda:/, '') ];\n\n  return name === propName && anyType(newElement, types);\n}\n\n\nfunction CamundaModdleExtension(eventBus) {\n\n  eventBus.on('property.clone', function(context) {\n    var newElement = context.newElement,\n        propDescriptor = context.propertyDescriptor;\n\n    this.canCloneProperty(newElement, propDescriptor);\n  }, this);\n}\n\nCamundaModdleExtension.$inject = [ 'eventBus' ];\n\nCamundaModdleExtension.prototype.canCloneProperty = function(newElement, propDescriptor) {\n\n  if (isAllowed('camunda:FailedJobRetryTimeCycle', propDescriptor, newElement)) {\n    return includesType(newElement.eventDefinitions, 'bpmn:TimerEventDefinition') ||\n           includesType(newElement.eventDefinitions, 'bpmn:SignalEventDefinition') ||\n           is(newElement.loopCharacteristics, 'bpmn:MultiInstanceLoopCharacteristics');\n  }\n\n  if (isAllowed('camunda:Connector', propDescriptor, newElement)) {\n    return includesType(newElement.eventDefinitions, 'bpmn:MessageEventDefinition');\n  }\n\n  if (isAllowed('camunda:Field', propDescriptor, newElement)) {\n    return includesType(newElement.eventDefinitions, 'bpmn:MessageEventDefinition');\n  }\n};\n\nmodule.exports = CamundaModdleExtension;\n"]},"metadata":{},"sourceType":"script"}