{"ast":null,"code":"'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny;\n\nvar find = require('lodash/find');\n\nvar TEMPLATE_ATTR = 'camunda:modelerTemplate';\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template is stored.\n *\n * @type {String}\n */\n\nmodule.exports.TEMPLATE_ATTR = TEMPLATE_ATTR;\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\n\nfunction getTemplateId(element) {\n  var bo = getBusinessObject(element);\n\n  if (bo) {\n    return bo.get(TEMPLATE_ATTR);\n  }\n}\n\nmodule.exports.getTemplateId = getTemplateId;\n/**\n * Get template of a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\n\nfunction getTemplate(element, elementTemplates) {\n  var id = getTemplateId(element);\n  return id && elementTemplates.get(id);\n}\n\nmodule.exports.getTemplate = getTemplate;\n/**\n * Get default template for a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\n\nfunction getDefaultTemplate(element, elementTemplates) {\n  // return first default template, if any exists\n  return elementTemplates.getAll().filter(function (t) {\n    return isAny(element, t.appliesTo) && t.isDefault;\n  })[0];\n}\n\nmodule.exports.getDefaultTemplate = getDefaultTemplate;\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\n\nfunction findExtension(element, type) {\n  var bo = getBusinessObject(element);\n  var extensionElements;\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    extensionElements = bo;\n  } else {\n    extensionElements = bo.extensionElements;\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return find(extensionElements.get('values'), function (e) {\n    return is(e, type);\n  });\n}\n\nmodule.exports.findExtension = findExtension;\n\nfunction findExtensions(element, types) {\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return [];\n  }\n\n  return extensionElements.get('values').filter(function (e) {\n    return isAny(e, types);\n  });\n}\n\nmodule.exports.findExtensions = findExtensions;\n\nfunction findCamundaInOut(element, binding) {\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return;\n  }\n\n  var matcher;\n\n  if (binding.type === 'camunda:in') {\n    matcher = function (e) {\n      return is(e, 'camunda:In') && isInOut(e, binding);\n    };\n  } else if (binding.type === 'camunda:out') {\n    matcher = function (e) {\n      return is(e, 'camunda:Out') && isInOut(e, binding);\n    };\n  } else if (binding.type === 'camunda:in:businessKey') {\n    matcher = function (e) {\n      return is(e, 'camunda:In') && 'businessKey' in e;\n    };\n  }\n\n  return find(extensionElements.get('values'), matcher);\n}\n\nmodule.exports.findCamundaInOut = findCamundaInOut;\n\nfunction findCamundaProperty(camundaProperties, binding) {\n  return find(camundaProperties.get('values'), function (p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findCamundaProperty = findCamundaProperty;\n\nfunction findInputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('inputParameters');\n  return find(parameters, function (p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findInputParameter = findInputParameter;\n\nfunction findOutputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('outputParameters');\n  return find(parameters, function (p) {\n    var value = p.value;\n\n    if (!binding.scriptFormat) {\n      return value === binding.source;\n    }\n\n    var definition = p.definition;\n\n    if (!definition || binding.scriptFormat !== definition.scriptFormat) {\n      return false;\n    }\n\n    return definition.value === binding.source;\n  });\n}\n\nmodule.exports.findOutputParameter = findOutputParameter; // helpers /////////////////////////////////\n\nfunction getExtensionElements(element) {\n  var bo = getBusinessObject(element);\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    return bo;\n  } else {\n    return bo.extensionElements;\n  }\n}\n\nfunction isInOut(element, binding) {\n  if (binding.type === 'camunda:in') {\n    // find based on target attribute\n    if (binding.target) {\n      return element.target === binding.target;\n    }\n  }\n\n  if (binding.type === 'camunda:out') {\n    // find based on source / sourceExpression\n    if (binding.source) {\n      return element.source === binding.source;\n    }\n\n    if (binding.sourceExpression) {\n      return element.sourceExpression === binding.sourceExpression;\n    }\n  } // find based variables / local combination\n\n\n  if (binding.variables) {\n    return element.variables === 'all' && (binding.variables !== 'local' || element.local);\n  }\n}","map":{"version":3,"sources":["C:/Users/Vittorio/Documents/GitHub/goal-bpmn/frontend/node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/Helper.js"],"names":["getBusinessObject","require","is","isAny","find","TEMPLATE_ATTR","module","exports","getTemplateId","element","bo","get","getTemplate","elementTemplates","id","getDefaultTemplate","getAll","filter","t","appliesTo","isDefault","findExtension","type","extensionElements","e","findExtensions","types","getExtensionElements","findCamundaInOut","binding","matcher","isInOut","findCamundaProperty","camundaProperties","p","name","findInputParameter","inputOutput","parameters","findOutputParameter","value","scriptFormat","source","definition","target","sourceExpression","variables","local"],"mappings":"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","sourcesContent":["'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny;\n\nvar find = require('lodash/find');\n\n\nvar TEMPLATE_ATTR = 'camunda:modelerTemplate';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template is stored.\n *\n * @type {String}\n */\nmodule.exports.TEMPLATE_ATTR = TEMPLATE_ATTR;\n\n\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nfunction getTemplateId(element) {\n\n  var bo = getBusinessObject(element);\n\n  if (bo) {\n    return bo.get(TEMPLATE_ATTR);\n  }\n}\n\nmodule.exports.getTemplateId = getTemplateId;\n\n\n/**\n * Get template of a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\nfunction getTemplate(element, elementTemplates) {\n  var id = getTemplateId(element);\n\n  return id && elementTemplates.get(id);\n}\n\nmodule.exports.getTemplate = getTemplate;\n\n/**\n * Get default template for a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\nfunction getDefaultTemplate(element, elementTemplates) {\n\n  // return first default template, if any exists\n  return (\n    elementTemplates.getAll().filter(function(t) {\n      return isAny(element, t.appliesTo) && t.isDefault;\n    })\n  )[0];\n}\n\nmodule.exports.getDefaultTemplate = getDefaultTemplate;\n\n\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\nfunction findExtension(element, type) {\n  var bo = getBusinessObject(element);\n\n  var extensionElements;\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    extensionElements = bo;\n  } else {\n    extensionElements = bo.extensionElements;\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return find(extensionElements.get('values'), function(e) {\n    return is(e, type);\n  });\n}\n\nmodule.exports.findExtension = findExtension;\n\n\nfunction findExtensions(element, types) {\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return [];\n  }\n\n  return extensionElements.get('values').filter(function(e) {\n    return isAny(e, types);\n  });\n}\n\nmodule.exports.findExtensions = findExtensions;\n\n\nfunction findCamundaInOut(element, binding) {\n\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return;\n  }\n\n  var matcher;\n\n  if (binding.type === 'camunda:in') {\n    matcher = function(e) {\n      return is(e, 'camunda:In') && isInOut(e, binding);\n    };\n  } else\n  if (binding.type === 'camunda:out') {\n    matcher = function(e) {\n      return is(e, 'camunda:Out') && isInOut(e, binding);\n    };\n  } else\n  if (binding.type === 'camunda:in:businessKey') {\n    matcher = function(e) {\n      return is(e, 'camunda:In') && 'businessKey' in e;\n    };\n  }\n\n  return find(extensionElements.get('values'), matcher);\n}\n\nmodule.exports.findCamundaInOut = findCamundaInOut;\n\nfunction findCamundaProperty(camundaProperties, binding) {\n  return find(camundaProperties.get('values'), function(p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findCamundaProperty = findCamundaProperty;\n\n\nfunction findInputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('inputParameters');\n\n  return find(parameters, function(p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findInputParameter = findInputParameter;\n\n\nfunction findOutputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('outputParameters');\n\n  return find(parameters, function(p) {\n    var value = p.value;\n\n    if (!binding.scriptFormat) {\n      return value === binding.source;\n    }\n\n    var definition = p.definition;\n\n    if (!definition || binding.scriptFormat !== definition.scriptFormat) {\n      return false;\n    }\n\n    return definition.value === binding.source;\n  });\n}\n\nmodule.exports.findOutputParameter = findOutputParameter;\n\n\n\n// helpers /////////////////////////////////\n\nfunction getExtensionElements(element) {\n  var bo = getBusinessObject(element);\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    return bo;\n  } else {\n    return bo.extensionElements;\n  }\n}\n\n\nfunction isInOut(element, binding) {\n\n  if (binding.type === 'camunda:in') {\n    // find based on target attribute\n    if (binding.target) {\n      return element.target === binding.target;\n    }\n  }\n\n  if (binding.type === 'camunda:out') {\n    // find based on source / sourceExpression\n    if (binding.source) {\n      return element.source === binding.source;\n    }\n\n    if (binding.sourceExpression) {\n      return element.sourceExpression === binding.sourceExpression;\n    }\n  }\n\n  // find based variables / local combination\n  if (binding.variables) {\n    return element.variables === 'all' && (\n      binding.variables !== 'local' || element.local\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"script"}