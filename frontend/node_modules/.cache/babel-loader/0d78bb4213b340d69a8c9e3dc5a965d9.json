{"ast":null,"code":"import { assign } from 'min-dash';\nimport { is } from './ModelUtil';\nexport var DEFAULT_LABEL_SIZE = {\n  width: 90,\n  height: 20\n};\nexport var FLOW_LABEL_INDENT = 15;\n/**\n * Returns true if the given semantic has an external label\n *\n * @param {BpmnElement} semantic\n * @return {Boolean} true if has label\n */\n\nexport function isLabelExternal(semantic) {\n  return is(semantic, 'bpmn:Event') || is(semantic, 'bpmn:Gateway') || is(semantic, 'bpmn:DataStoreReference') || is(semantic, 'bpmn:DataObjectReference') || is(semantic, 'bpmn:DataInput') || is(semantic, 'bpmn:DataOutput') || is(semantic, 'bpmn:SequenceFlow') || is(semantic, 'bpmn:MessageFlow');\n}\n/**\n * Returns true if the given element has an external label\n *\n * @param {djs.model.shape} element\n * @return {Boolean} true if has label\n */\n\nexport function hasExternalLabel(element) {\n  return isLabel(element.label);\n}\n/**\n * Get the position for sequence flow labels\n *\n * @param  {Array<Point>} waypoints\n * @return {Point} the label position\n */\n\nexport function getFlowLabelPosition(waypoints) {\n  // get the waypoints mid\n  var mid = waypoints.length / 2 - 1;\n  var first = waypoints[Math.floor(mid)];\n  var second = waypoints[Math.ceil(mid + 0.01)]; // get position\n\n  var position = getWaypointsMid(waypoints); // calculate angle\n\n  var angle = Math.atan((second.y - first.y) / (second.x - first.x));\n  var x = position.x,\n      y = position.y;\n\n  if (Math.abs(angle) < Math.PI / 2) {\n    y -= FLOW_LABEL_INDENT;\n  } else {\n    x += FLOW_LABEL_INDENT;\n  }\n\n  return {\n    x: x,\n    y: y\n  };\n}\n/**\n * Get the middle of a number of waypoints\n *\n * @param  {Array<Point>} waypoints\n * @return {Point} the mid point\n */\n\nexport function getWaypointsMid(waypoints) {\n  var mid = waypoints.length / 2 - 1;\n  var first = waypoints[Math.floor(mid)];\n  var second = waypoints[Math.ceil(mid + 0.01)];\n  return {\n    x: first.x + (second.x - first.x) / 2,\n    y: first.y + (second.y - first.y) / 2\n  };\n}\nexport function getExternalLabelMid(element) {\n  if (element.waypoints) {\n    return getFlowLabelPosition(element.waypoints);\n  } else {\n    return {\n      x: element.x + element.width / 2,\n      y: element.y + element.height + DEFAULT_LABEL_SIZE.height / 2\n    };\n  }\n}\n/**\n * Returns the bounds of an elements label, parsed from the elements DI or\n * generated from its bounds.\n *\n * @param {BpmnElement} semantic\n * @param {djs.model.Base} element\n */\n\nexport function getExternalLabelBounds(semantic, element) {\n  var mid,\n      size,\n      bounds,\n      di = semantic.di,\n      label = di.label;\n\n  if (label && label.bounds) {\n    bounds = label.bounds;\n    size = {\n      width: Math.max(DEFAULT_LABEL_SIZE.width, bounds.width),\n      height: bounds.height\n    };\n    mid = {\n      x: bounds.x + bounds.width / 2,\n      y: bounds.y + bounds.height / 2\n    };\n  } else {\n    mid = getExternalLabelMid(element);\n    size = DEFAULT_LABEL_SIZE;\n  }\n\n  return assign({\n    x: mid.x - size.width / 2,\n    y: mid.y - size.height / 2\n  }, size);\n}\nexport function isLabel(element) {\n  return element && element.labelTarget;\n}","map":{"version":3,"sources":["C:/Users/Vittorio/Documents/GitHub/goal-bpmn/frontend/node_modules/bpmn-js/lib/util/LabelUtil.js"],"names":["assign","is","DEFAULT_LABEL_SIZE","width","height","FLOW_LABEL_INDENT","isLabelExternal","semantic","hasExternalLabel","element","isLabel","label","getFlowLabelPosition","waypoints","mid","length","first","Math","floor","second","ceil","position","getWaypointsMid","angle","atan","y","x","abs","PI","getExternalLabelMid","getExternalLabelBounds","size","bounds","di","max","labelTarget"],"mappings":"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","sourcesContent":["import {\n  assign\n} from 'min-dash';\n\nimport { is } from './ModelUtil';\n\n\nexport var DEFAULT_LABEL_SIZE = {\n  width: 90,\n  height: 20\n};\n\nexport var FLOW_LABEL_INDENT = 15;\n\n\n/**\n * Returns true if the given semantic has an external label\n *\n * @param {BpmnElement} semantic\n * @return {Boolean} true if has label\n */\nexport function isLabelExternal(semantic) {\n  return is(semantic, 'bpmn:Event') ||\n         is(semantic, 'bpmn:Gateway') ||\n         is(semantic, 'bpmn:DataStoreReference') ||\n         is(semantic, 'bpmn:DataObjectReference') ||\n         is(semantic, 'bpmn:DataInput') ||\n         is(semantic, 'bpmn:DataOutput') ||\n         is(semantic, 'bpmn:SequenceFlow') ||\n         is(semantic, 'bpmn:MessageFlow');\n}\n\n/**\n * Returns true if the given element has an external label\n *\n * @param {djs.model.shape} element\n * @return {Boolean} true if has label\n */\nexport function hasExternalLabel(element) {\n  return isLabel(element.label);\n}\n\n/**\n * Get the position for sequence flow labels\n *\n * @param  {Array<Point>} waypoints\n * @return {Point} the label position\n */\nexport function getFlowLabelPosition(waypoints) {\n\n  // get the waypoints mid\n  var mid = waypoints.length / 2 - 1;\n\n  var first = waypoints[Math.floor(mid)];\n  var second = waypoints[Math.ceil(mid + 0.01)];\n\n  // get position\n  var position = getWaypointsMid(waypoints);\n\n  // calculate angle\n  var angle = Math.atan((second.y - first.y) / (second.x - first.x));\n\n  var x = position.x,\n      y = position.y;\n\n  if (Math.abs(angle) < Math.PI / 2) {\n    y -= FLOW_LABEL_INDENT;\n  } else {\n    x += FLOW_LABEL_INDENT;\n  }\n\n  return { x: x, y: y };\n}\n\n\n/**\n * Get the middle of a number of waypoints\n *\n * @param  {Array<Point>} waypoints\n * @return {Point} the mid point\n */\nexport function getWaypointsMid(waypoints) {\n\n  var mid = waypoints.length / 2 - 1;\n\n  var first = waypoints[Math.floor(mid)];\n  var second = waypoints[Math.ceil(mid + 0.01)];\n\n  return {\n    x: first.x + (second.x - first.x) / 2,\n    y: first.y + (second.y - first.y) / 2\n  };\n}\n\n\nexport function getExternalLabelMid(element) {\n\n  if (element.waypoints) {\n    return getFlowLabelPosition(element.waypoints);\n  } else {\n    return {\n      x: element.x + element.width / 2,\n      y: element.y + element.height + DEFAULT_LABEL_SIZE.height / 2\n    };\n  }\n}\n\n\n/**\n * Returns the bounds of an elements label, parsed from the elements DI or\n * generated from its bounds.\n *\n * @param {BpmnElement} semantic\n * @param {djs.model.Base} element\n */\nexport function getExternalLabelBounds(semantic, element) {\n\n  var mid,\n      size,\n      bounds,\n      di = semantic.di,\n      label = di.label;\n\n  if (label && label.bounds) {\n    bounds = label.bounds;\n\n    size = {\n      width: Math.max(DEFAULT_LABEL_SIZE.width, bounds.width),\n      height: bounds.height\n    };\n\n    mid = {\n      x: bounds.x + bounds.width / 2,\n      y: bounds.y + bounds.height / 2\n    };\n  } else {\n\n    mid = getExternalLabelMid(element);\n\n    size = DEFAULT_LABEL_SIZE;\n  }\n\n  return assign({\n    x: mid.x - size.width / 2,\n    y: mid.y - size.height / 2\n  }, size);\n}\n\nexport function isLabel(element) {\n  return element && element.labelTarget;\n}\n"]},"metadata":{},"sourceType":"module"}