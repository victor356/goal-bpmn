{"ast":null,"code":"import { set as cursorSet, unset as cursorUnset } from '../../util/Cursor';\nimport { install as installClickTrap } from '../../util/ClickTrap';\nimport { delta as deltaPos } from '../../util/PositionUtil';\nimport { event as domEvent, closest as domClosest } from 'min-dom';\nimport { toPoint } from '../../util/Event';\nvar THRESHOLD = 15;\n/**\n * Move the canvas via mouse.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\n\nexport default function MoveCanvas(eventBus, canvas) {\n  var context; // listen for move on element mouse down;\n  // allow others to hook into the event before us though\n  // (dragging / element moving will do this)\n\n  eventBus.on('element.mousedown', 500, function (e) {\n    return handleStart(e.originalEvent);\n  });\n\n  function handleMove(event) {\n    var start = context.start,\n        position = toPoint(event),\n        delta = deltaPos(position, start);\n\n    if (!context.dragging && length(delta) > THRESHOLD) {\n      context.dragging = true;\n      installClickTrap(eventBus);\n      cursorSet('grab');\n    }\n\n    if (context.dragging) {\n      var lastPosition = context.last || context.start;\n      delta = deltaPos(position, lastPosition);\n      canvas.scroll({\n        dx: delta.x,\n        dy: delta.y\n      });\n      context.last = position;\n    } // prevent select\n\n\n    event.preventDefault();\n  }\n\n  function handleEnd(event) {\n    domEvent.unbind(document, 'mousemove', handleMove);\n    domEvent.unbind(document, 'mouseup', handleEnd);\n    context = null;\n    cursorUnset();\n  }\n\n  function handleStart(event) {\n    // event is already handled by '.djs-draggable'\n    if (domClosest(event.target, '.djs-draggable')) {\n      return;\n    } // reject non-left left mouse button or modifier key\n\n\n    if (event.button || event.ctrlKey || event.shiftKey || event.altKey) {\n      return;\n    }\n\n    context = {\n      start: toPoint(event)\n    };\n    domEvent.bind(document, 'mousemove', handleMove);\n    domEvent.bind(document, 'mouseup', handleEnd); // we've handled the event\n\n    return true;\n  }\n}\nMoveCanvas.$inject = ['eventBus', 'canvas']; // helpers ///////\n\nfunction length(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}","map":{"version":3,"sources":["C:/Users/Vittorio/Documents/GitHub/goal-bpmn/frontend/node_modules/diagram-js/lib/navigation/movecanvas/MoveCanvas.js"],"names":["set","cursorSet","unset","cursorUnset","install","installClickTrap","delta","deltaPos","event","domEvent","closest","domClosest","toPoint","THRESHOLD","MoveCanvas","eventBus","canvas","context","on","e","handleStart","originalEvent","handleMove","start","position","dragging","length","lastPosition","last","scroll","dx","x","dy","y","preventDefault","handleEnd","unbind","document","target","button","ctrlKey","shiftKey","altKey","bind","$inject","point","Math","sqrt","pow"],"mappings":"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","sourcesContent":["import {\n  set as cursorSet,\n  unset as cursorUnset\n} from '../../util/Cursor';\n\nimport {\n  install as installClickTrap\n} from '../../util/ClickTrap';\n\nimport {\n  delta as deltaPos\n} from '../../util/PositionUtil';\n\nimport {\n  event as domEvent,\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\n\nvar THRESHOLD = 15;\n\n\n/**\n * Move the canvas via mouse.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function MoveCanvas(eventBus, canvas) {\n\n  var context;\n\n\n  // listen for move on element mouse down;\n  // allow others to hook into the event before us though\n  // (dragging / element moving will do this)\n  eventBus.on('element.mousedown', 500, function(e) {\n    return handleStart(e.originalEvent);\n  });\n\n\n  function handleMove(event) {\n\n    var start = context.start,\n        position = toPoint(event),\n        delta = deltaPos(position, start);\n\n    if (!context.dragging && length(delta) > THRESHOLD) {\n      context.dragging = true;\n\n      installClickTrap(eventBus);\n\n      cursorSet('grab');\n    }\n\n    if (context.dragging) {\n\n      var lastPosition = context.last || context.start;\n\n      delta = deltaPos(position, lastPosition);\n\n      canvas.scroll({\n        dx: delta.x,\n        dy: delta.y\n      });\n\n      context.last = position;\n    }\n\n    // prevent select\n    event.preventDefault();\n  }\n\n\n  function handleEnd(event) {\n    domEvent.unbind(document, 'mousemove', handleMove);\n    domEvent.unbind(document, 'mouseup', handleEnd);\n\n    context = null;\n\n    cursorUnset();\n  }\n\n  function handleStart(event) {\n    // event is already handled by '.djs-draggable'\n    if (domClosest(event.target, '.djs-draggable')) {\n      return;\n    }\n\n\n    // reject non-left left mouse button or modifier key\n    if (event.button || event.ctrlKey || event.shiftKey || event.altKey) {\n      return;\n    }\n\n    context = {\n      start: toPoint(event)\n    };\n\n    domEvent.bind(document, 'mousemove', handleMove);\n    domEvent.bind(document, 'mouseup', handleEnd);\n\n    // we've handled the event\n    return true;\n  }\n}\n\n\nMoveCanvas.$inject = [\n  'eventBus',\n  'canvas'\n];\n\n\n\n// helpers ///////\n\nfunction length(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}\n"]},"metadata":{},"sourceType":"module"}