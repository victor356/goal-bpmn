{"ast":null,"code":"import inherits from 'inherits';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\nimport { is } from '../../../util/ModelUtil';\nimport { getChildLanes } from '../util/LaneUtil';\nimport { eachElement } from 'diagram-js/lib/util/Elements';\nvar LOW_PRIORITY = 500;\n/**\n * BPMN specific delete lane behavior\n */\n\nexport default function DeleteLaneBehavior(eventBus, modeling, spaceTool) {\n  CommandInterceptor.call(this, eventBus);\n\n  function compensateLaneDelete(shape, oldParent) {\n    var siblings = getChildLanes(oldParent);\n    var topAffected = [];\n    var bottomAffected = [];\n    eachElement(siblings, function (element) {\n      if (element.y > shape.y) {\n        bottomAffected.push(element);\n      } else {\n        topAffected.push(element);\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    var offset;\n\n    if (bottomAffected.length && topAffected.length) {\n      offset = shape.height / 2;\n    } else {\n      offset = shape.height;\n    }\n\n    var topAdjustments, bottomAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(topAffected, 'y', offset, shape.y - 10);\n      spaceTool.makeSpace(topAdjustments.movingShapes, topAdjustments.resizingShapes, {\n        x: 0,\n        y: offset\n      }, 's');\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n      spaceTool.makeSpace(bottomAdjustments.movingShapes, bottomAdjustments.resizingShapes, {\n        x: 0,\n        y: -offset\n      }, 'n');\n    }\n  }\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n\n\n  this.postExecuted('shape.delete', LOW_PRIORITY, function (event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        oldParent = context.oldParent; // only compensate lane deletes\n\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    } // compensate root deletes only\n\n\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\nDeleteLaneBehavior.$inject = ['eventBus', 'modeling', 'spaceTool'];\ninherits(DeleteLaneBehavior, CommandInterceptor);","map":{"version":3,"sources":["C:/Users/Vittorio/Documents/GitHub/goal-bpmn/frontend/node_modules/bpmn-js/lib/features/modeling/behavior/DeleteLaneBehavior.js"],"names":["inherits","CommandInterceptor","is","getChildLanes","eachElement","LOW_PRIORITY","DeleteLaneBehavior","eventBus","modeling","spaceTool","call","compensateLaneDelete","shape","oldParent","siblings","topAffected","bottomAffected","element","y","push","children","length","offset","height","topAdjustments","bottomAdjustments","calculateAdjustments","makeSpace","movingShapes","resizingShapes","x","postExecuted","event","context","hints","nested","$inject"],"mappings":"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","sourcesContent":["import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  getChildLanes\n} from '../util/LaneUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function DeleteLaneBehavior(eventBus, modeling, spaceTool) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function compensateLaneDelete(shape, oldParent) {\n\n    var siblings = getChildLanes(oldParent);\n\n    var topAffected = [];\n    var bottomAffected = [];\n\n    eachElement(siblings, function(element) {\n\n      if (element.y > shape.y) {\n        bottomAffected.push(element);\n      } else {\n        topAffected.push(element);\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    var offset;\n\n    if (bottomAffected.length && topAffected.length) {\n      offset = shape.height / 2;\n    } else {\n      offset = shape.height;\n    }\n\n    var topAdjustments,\n        bottomAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(\n        topAffected, 'y', offset, shape.y - 10);\n\n      spaceTool.makeSpace(\n        topAdjustments.movingShapes,\n        topAdjustments.resizingShapes,\n        { x: 0, y: offset }, 's');\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(\n        bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n\n      spaceTool.makeSpace(\n        bottomAdjustments.movingShapes,\n        bottomAdjustments.resizingShapes,\n        { x: 0, y: -offset }, 'n');\n    }\n  }\n\n\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n  this.postExecuted('shape.delete', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        oldParent = context.oldParent;\n\n    // only compensate lane deletes\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    }\n\n    // compensate root deletes only\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\n\nDeleteLaneBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'spaceTool'\n];\n\ninherits(DeleteLaneBehavior, CommandInterceptor);"]},"metadata":{},"sourceType":"module"}